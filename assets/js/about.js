const aboutText = {
    "gioi_thieu": {
        title: "Giới thiệu về Festival Huế",
        mean: `            Festival Huế là sự kiện văn hóa - du lịch mang tầm quốc gia và quốc tế, được tổ chức định kỳ 2 năm một lần vào các năm chẵn tại Cố đô Huế. Đây là dịp để tôn vinh di sản, tái hiện đời sống văn hóa cung đình và dân gian thông qua hàng loạt chương trình nghệ thuật đặc sắc.
            Từ năm 2025, Festival Huế đánh dấu bước chuyển mình với chuỗi hoạt động diễn ra quanh năm theo chủ đề “Festival bốn mùa”, mở ra không gian lễ hội trải dài từ tháng 1 đến tháng 12, giúp du khách có thể hòa mình vào dòng chảy văn hóa Huế bất kỳ thời điểm nào.
            Các chương trình tiêu biểu như: Đêm Hoàng cung, Lễ tế Nam Giao, Lễ Truyền lô và Vinh quy bái tổ, Lễ hội Áo dài, trình diễn nghệ thuật đường phố, thả diều, thả thơ, ngâm thơ, chợ quê ngày hội, đua thuyền, cờ người... góp phần làm sống lại những giá trị truyền thống của vùng đất cố đô.
            Năm 2025, Festival Huế cũng là sự kiện trọng điểm trong khuôn khổ Năm Du lịch Quốc gia - Huế 2025, đồng thời kỷ niệm 50 năm ngày Giải phóng Huế (1975-2025), khẳng định vai trò Huế trong liên kết phát triển văn hóa - du lịch khu vực miền Trung và cả nước.`,
        image: "about1.jpg"
    },
    "mua_xuan": {
        title: " Lễ hội mùa Xuân - “Xuân Cố đô”",
        mean: `            Mỗi dịp Tết đến xuân về, Huế lại trở thành điểm đến đầy sắc xuân và chiều sâu văn hóa. Đây không chỉ là thời khắc giao hòa của trời đất, mà còn là dịp để người dân tưởng nhớ tổ tiên, cầu mong một năm mới bình an, hạnh phúc và cùng nhau trải nghiệm các lễ hội truyền thống rộn ràng.
            Nhiều hoạt động đặc sắc được tổ chức khắp thành phố và các huyện: từ lễ Khai hạ (Hạ nêu) tại Hoàng cung vào mùng 7 Tết, đến Lễ hội đền Huyền Trân vào mùng 8-9 tháng Giêng với các nghi lễ tưởng niệm công chúa Huyền Trân cùng không gian văn hóa dân gian: trình diễn áo dài, ca Huế, bài chòi, thư pháp...
            Đặc biệt, mùa xuân 2025 nằm trong chuỗi sự kiện Festival Huế và Năm Du lịch quốc gia - Huế 2025, với các chương trình được tổ chức quy mô, bài bản hơn. Nổi bật là Ngày hội Tinh hoa Võ Việt lần thứ nhất - Huế 2025, chương trình nghệ thuật Khai mạc Năm Du lịch quốc gia và lễ kỷ niệm 50 năm giải phóng Huế.
            “Xuân Cố đô” không chỉ là mùa của lễ hội mà còn là mùa của ký ức, lòng tri ân và khát vọng phát triển bền vững của một vùng đất di sản.`,
        image: "about2.jpg"
    },
    "mua_ha": {
        title: "Lễ hội mùa Hạ - “Kinh thành toả sáng”",
        mean: `            Khi ánh nắng mùa hạ phủ vàng lên từng mái ngói rêu phong của Kinh thành Huế, cũng là lúc nơi đây bước vào giai đoạn rực rỡ nhất của Festival bốn mùa. “Kinh thành tỏa sáng” không chỉ là tên gọi, mà còn là hình ảnh biểu tượng cho một Huế sôi động, bừng lên sức sống giữa lòng di sản.
            Mùa Hạ là mùa của nghệ thuật trình diễn đỉnh cao, với các chương trình nổi bật như: lễ hội Áo dài truyền thống và hiện đại, lễ hội đường phố rực rỡ sắc màu, chương trình nghệ thuật cộng đồng và các đêm nhạc lớn quy tụ nghệ sĩ trong nước và quốc tế.
            Điểm nhấn đặc biệt là Triển lãm “Không gian du lịch, di sản văn hóa và danh thắng Việt Nam năm 2025”, nơi du khách có thể khám phá chiều sâu di sản khắp ba miền đất nước. Bên cạnh đó, Chung kết Hoa hậu Việt Nam tại Huế hứa hẹn mang đến hình ảnh thanh lịch, duyên dáng của người phụ nữ Việt giữa lòng di sản.
            Không thể thiếu trong hành trình mùa Hạ là không gian ẩm thực đặc sắc – từ Tuần lễ Phật Đản và Lễ hội Ẩm thực chay đầy thanh tịnh, đến Giao lưu Ẩm thực Quốc tế Huế với hương vị đa quốc gia hòa quyện cùng tinh hoa ẩm thực cố đô. Đây là dịp để du khách cảm nhận trọn vẹn chiều sâu văn hóa Huế qua vị giác và tinh thần.
            “Kinh thành tỏa sáng” vì thế không chỉ là biểu tượng của vẻ đẹp lung linh về đêm tại Hoàng thành Huế, mà còn là thông điệp về một Huế bừng lên sức sống mới – trẻ trung, sáng tạo nhưng vẫn giữ trọn bản sắc văn hóa lâu đời.`,
        image: "about3.jpg"
    },
    "mua_thu": {
        title: "Lễ hội mùa Thu - “Huế vào Thu”",
        mean: `            Mùa Thu phủ lên Huế một vẻ đẹp trầm lắng, dịu dàng, là thời điểm lý tưởng để cảm nhận sự giao thoa giữa truyền thống và hiện đại qua các lễ hội rực rỡ sắc màu.
            Điểm nhấn đặc biệt của mùa Thu là chuỗi sự kiện Tết Trung Thu kéo dài từ tháng 7 đến tháng 9 âm lịch, mang đến không khí lễ hội náo nhiệt và đầy sắc màu cho cả người dân và du khách. Các hoạt động tiêu biểu như: Ngày hội Quảng diễn Lân - Sư - Rồng, Hội rước đèn Trung thu đường phố, các màn diễn Lân Huế đặc sắc và Hội đèn lồng quốc tế Huế 2025 đã góp phần thắp sáng đêm Thu bằng ánh sáng văn hóa truyền thống.
            “Huế vào Thu” không chỉ là mùa của ánh trăng và đèn lồng, mà còn là mùa của hoài niệm, sum vầy và niềm vui trẻ thơ, giúp gắn kết cộng đồng và lan tỏa nét đẹp văn hóa đặc trưng của vùng đất Cố đô.`,
        image: "about4.jpg"
    },
    "mua_dong": {
        title: "Lễ hội mùa Đông - “Mùa Đông xứ Huế”",
        mean: `            Khi cái lạnh len lỏi về trên từng con phố, mùa đông xứ Huế lại trở nên ấm áp nhờ những hoạt động lễ hội sôi động, hấp dẫn. Đây không chỉ là thời điểm kết thúc một năm trọn vẹn, mà còn là dịp để du khách trải nghiệm vẻ đẹp tĩnh lặng pha lẫn náo nhiệt của Cố đô.
            Lễ hội mùa Đông được tổ chức với nhiều chương trình mới lạ và cuốn hút, mang đến không khí lễ hội tràn đầy sức sống. Du khách sẽ được hòa mình vào các loại hình vui chơi, giải trí đa dạng trong suốt kỳ nghỉ tại Huế.
            Điểm nhấn trong mùa này là Lễ bế mạc Năm Du lịch quốc gia - Huế 2025 và Tuần lễ Âm nhạc Quốc tế, quy tụ các nghệ sĩ tài năng trong nước và quốc tế. Bên cạnh đó, chương trình nghệ thuật Countdown - Chào đón năm mới 2026 hứa hẹn mang đến một đêm cuối năm bùng nổ cảm xúc, khép lại hành trình Festival bốn mùa đầy ấn tượng.`,
        image: "about5.jpg"
    }
}

const clickSound = new Audio('./assets/sounds/click.mp3');
let index_xuan = 0;
let index_ha = 0;
let index_thu = 0;
let index_dong = 0;

function showEvent(event) {
    const aboutImg = document.querySelector('.about-img');
    const aboutTitle = document.getElementById('about-title');
    const aboutMean = document.getElementById('about-mean');

    if (aboutText[event]) {
        // Add loading state
        aboutImg.classList.add('loading');

        // Create a new image to preload
        const img = new Image();
        img.onload = () => {
            // Remove loading state and update background
            aboutImg.classList.remove('loading');
            aboutImg.style.backgroundImage = `url(./assets/images/${aboutText[event].image})`;

            // Add fade-in animation
            aboutImg.style.opacity = '0';
            setTimeout(() => {
                aboutImg.style.transition = 'opacity 0.5s ease-in-out';
                aboutImg.style.opacity = '1';
            }, 50);
        };
        img.src = `./assets/images/${aboutText[event].image}`;

        // Update text content with animation
        aboutTitle.style.opacity = '0';
        aboutMean.style.opacity = '0';

        setTimeout(() => {
            aboutTitle.textContent = aboutText[event].title;
            aboutMean.textContent = aboutText[event].mean;

            aboutTitle.style.transition = 'opacity 0.3s ease-in-out';
            aboutMean.style.transition = 'opacity 0.3s ease-in-out';
            aboutTitle.style.opacity = '1';
            aboutMean.style.opacity = '1';
        }, 150);
    }

    // Update active state with improved animation
    const items = document.querySelectorAll(".aboutItem");
    items.forEach(item => {
        item.classList.remove("selectedAboutItem", "active");
        item.style.transform = '';
    });

    // Find the clicked item and add active class
    const clickedItem = event.target ?.closest('.aboutItem') ||
        document.querySelector(`[onclick*="${event}"]`);
    if (clickedItem) {
        clickedItem.classList.add("selectedAboutItem", "active");

        // Add special animation for active item
        setTimeout(() => {
            clickedItem.style.transform = 'translateX(8px) scale(1.02)';
        }, 100);
    }

    // Scroll to top of text content with smooth animation
    const textContent = document.querySelector('.text-content');
    if (textContent) {
        textContent.style.scrollBehavior = 'smooth';
        textContent.scrollTop = 0;
    }

    // Clean up any existing modals
    const existingModals = document.querySelectorAll('.gallery-modal');
    existingModals.forEach(modal => modal.remove());


    const seasonImages = {
        mua_xuan: [{
                src: 'xuan1.png',
                title: 'Lễ hội đền Huyền Trân Công Chúa'
            },
            {
                src: 'xuan2.png',
                title: 'Chương trình khai mạc năm du lịch quốc gia'
            },
            {
                src: 'xuan3.png',
                title: 'Ngày hội Tinh hoa Võ Việt lần thứ nhất - Huế 2025'
            }
        ],
        mua_ha: [{
                src: 'ha1.png',
                title: 'Tuần lễ Phật Đản và Lễ hội Ẩm thực chay'
            },
            {
                src: 'ha2.png',
                title: 'Chương trình “Huế - Kinh đô ẩm thực”'
            },
            {
                src: 'ha3.png',
                title: 'Tuần lễ áo dài cộng đồng Huế'
            }
        ],
        mua_thu: [{
                src: 'thu1.png',
                title: 'Ngày hội Thể thao vì sức khỏe cộng đồng - Hue Sports Festival 2025'
            },
            {
                src: 'thu2.png',
                title: 'Hội đèn lồng quốc tế Huế 2025'
            },
            {
                src: 'thu3.png',
                title: 'Ngày hội Quảng diễn Lân - Sư - Rồng & Hội rước đèn Trung thu'
            }
        ],
        mua_dong: [{
                src: 'dong1.png',
                title: 'Tuồng Huế, Ngàn xưa âm vọng'
            },
            {
                src: 'dong2.png',
                title: 'Tuần lễ Âm nhạc quốc tế Huế 2025'
            },
            {
                src: 'dong3.png',
                title: 'Bế mạc Năm Du lịch quốc gia Huế - 2025'
            },
        ]
    };

    const seasonImagesContainer = document.getElementById('season-images');
    if (seasonImagesContainer) {
        seasonImagesContainer.innerHTML = ''; // Clear old content

        if (event !== 'gioi_thieu' && seasonImages[event]) {
            // Create a modern image gallery
            createSeasonImageGallery(seasonImagesContainer, seasonImages[event], event);
        }
    }
}

function createSeasonImageGallery(container, images, season) {
    // Create gallery wrapper
    const galleryWrapper = document.createElement('div');
    galleryWrapper.className = 'season-gallery';
    galleryWrapper.style.cssText = `
        position: absolute;
        top: 15px;
        right: 15px;
        width: 60px;
        height: 60px;
        background: rgba(218, 182, 125, 0.9);
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(218, 182, 125, 0.3);
        z-index: 10;
    `;

    // Create gallery icon
    const galleryIcon = document.createElement('div');
    galleryIcon.innerHTML = '📷';
    galleryIcon.style.cssText = `
        font-size: 1.5rem;
        transition: transform 0.3s ease;
    `;

    // Create tooltip
    const tooltip = document.createElement('div');
    tooltip.textContent = 'Xem thêm ảnh sự kiện';
    tooltip.style.cssText = `
        position: absolute;
        bottom: -35px;
        right: 0;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 0.8rem;
        white-space: nowrap;
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
    `;

    // Create modal overlay
    const modalOverlay = document.createElement('div');
    modalOverlay.className = 'gallery-modal';
    modalOverlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        backdrop-filter: blur(10px);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
    `;

    // Create modal content
    const modalContent = document.createElement('div');
    modalContent.style.cssText = `
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 2rem;
        max-width: 90vw;
        max-height: 90vh;
        overflow-y: auto;
        border: 1px solid rgba(218, 182, 125, 0.3);
    `;

    // Create modal header
    const modalHeader = document.createElement('div');
    modalHeader.style.cssText = `
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        color: white;
    `;

    const modalTitle = document.createElement('h3');
    modalTitle.textContent = `Sự kiện ${getSeasonName(season)}`;
    modalTitle.style.cssText = `
        margin: 0;
        color: #dab67d;
        font-size: 1.5rem;
        font-weight: 700;
    `;

    const closeButton = document.createElement('button');
    closeButton.innerHTML = '✕';
    closeButton.style.cssText = `
        background: none;
        border: none;
        color: #dab67d;
        font-size: 1.5rem;
        cursor: pointer;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s ease;
    `;

    // Create image grid
    const imageGrid = document.createElement('div');
    imageGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
    `;

    // Add images to grid
    images.forEach((image, index) => {
        const imageCard = document.createElement('div');
        imageCard.style.cssText = `
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid rgba(218, 182, 125, 0.2);
            transition: transform 0.3s ease;
            cursor: pointer;
        `;

        const img = document.createElement('img');
        img.src = `./assets/images/${image.src}`;
        img.alt = image.title;
        img.style.cssText = `
            width: 100%;
            height: 200px;
            object-fit: cover;
        `;

        const imageTitle = document.createElement('div');
        imageTitle.textContent = image.title;
        imageTitle.style.cssText = `
            padding: 1rem;
            color: white;
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
            line-height: 1.4;
        `;

        imageCard.appendChild(img);
        imageCard.appendChild(imageTitle);
        imageGrid.appendChild(imageCard);

        // Add hover effect
        imageCard.addEventListener('mouseenter', () => {
            imageCard.style.transform = 'translateY(-5px)';
        });

        imageCard.addEventListener('mouseleave', () => {
            imageCard.style.transform = 'translateY(0)';
        });
    });

    // Event listeners
    galleryWrapper.addEventListener('mouseenter', () => {
        galleryWrapper.style.transform = 'scale(1.1)';
        galleryWrapper.style.background = 'rgba(218, 182, 125, 1)';
        galleryIcon.style.transform = 'scale(1.2)';
        tooltip.style.opacity = '1';
    });

    galleryWrapper.addEventListener('mouseleave', () => {
        galleryWrapper.style.transform = 'scale(1)';
        galleryWrapper.style.background = 'rgba(218, 182, 125, 0.9)';
        galleryIcon.style.transform = 'scale(1)';
        tooltip.style.opacity = '0';
    });

    galleryWrapper.addEventListener('click', () => {
        modalOverlay.style.display = 'flex';
        setTimeout(() => {
            modalOverlay.style.opacity = '1';
        }, 10);
    });

    closeButton.addEventListener('click', () => {
        modalOverlay.style.opacity = '0';
        setTimeout(() => {
            modalOverlay.style.display = 'none';
        }, 300);
    });

    closeButton.addEventListener('mouseenter', () => {
        closeButton.style.background = 'rgba(218, 182, 125, 0.2)';
    });

    closeButton.addEventListener('mouseleave', () => {
        closeButton.style.background = 'none';
    });

    modalOverlay.addEventListener('click', (e) => {
        if (e.target === modalOverlay) {
            modalOverlay.style.opacity = '0';
            setTimeout(() => {
                modalOverlay.style.display = 'none';
            }, 300);
        }
    });

    // Assemble components
    galleryWrapper.appendChild(galleryIcon);
    galleryWrapper.appendChild(tooltip);

    modalHeader.appendChild(modalTitle);
    modalHeader.appendChild(closeButton);

    modalContent.appendChild(modalHeader);
    modalContent.appendChild(imageGrid);

    modalOverlay.appendChild(modalContent);



    container.appendChild(galleryWrapper);
    document.body.appendChild(modalOverlay);
    //prevent scroll when modal is open
    document.querySelectorAll('.gallery-modal').forEach(item => {
        item.addEventListener('wheel', function (e) {
            e.stopPropagation();
        });
    });
}

function getSeasonName(season) {
    const seasonNames = {
        'mua_xuan': 'Mùa Xuân',
        'mua_ha': 'Mùa Hạ',
        'mua_thu': 'Mùa Thu',
        'mua_dong': 'Mùa Đông'
    };
    return seasonNames[season] || 'Festival Huế';
}

// Add typing effect for text content
function typeText(element, text, speed = 20) {
    element.textContent = '';
    element.style.opacity = '1';

    let i = 0;
    const timer = setInterval(() => {
        if (i < text.length) {
            element.textContent += text.charAt(i);
            i++;
        } else {
            clearInterval(timer);
        }
    }, speed);

    return timer;
}

// Add smooth reveal animation for elements
function revealElement(element, delay = 0) {
    element.style.opacity = '0';
    element.style.transform = 'translateY(20px)';
    element.style.transition = 'all 0.6s ease-out';

    setTimeout(() => {
        element.style.opacity = '1';
        element.style.transform = 'translateY(0)';
    }, delay);
}

// Add intersection observer for scroll animations
function setupScrollAnimations() {
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate-in');
            }
        });
    }, observerOptions);

    // Observe about section elements
    const aboutElements = document.querySelectorAll('.aboutFes, .aboutContent, .about-header');
    aboutElements.forEach(el => observer.observe(el));
}

window.onload = () => {
    showEvent('gioi_thieu'); // Default to introduction when page loads

    // Set the first item as active
    const firstItem = document.querySelector('.aboutItem');
    if (firstItem) {
        firstItem.classList.add('active');
    }

    // Setup scroll animations
    setupScrollAnimations();

    // Add keyboard navigation support
    document.addEventListener('keydown', (e) => {
        if (document.querySelector('#about').classList.contains('active')) {
            const items = Array.from(document.querySelectorAll('.aboutItem'));
            const currentIndex = items.findIndex(item => item.classList.contains('active'));

            if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                e.preventDefault();
                const prevIndex = currentIndex > 0 ? currentIndex - 1 : items.length - 1;
                const eventName = items[prevIndex].getAttribute('onclick').match(/'([^']+)'/)[1];
                showEvent(eventName);
            } else if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
                e.preventDefault();
                const nextIndex = currentIndex < items.length - 1 ? currentIndex + 1 : 0;
                const eventName = items[nextIndex].getAttribute('onclick').match(/'([^']+)'/)[1];
                showEvent(eventName);
            }
        }
    });

    // Add touch gesture support for mobile
    let touchStartX = 0;
    let touchStartY = 0;

    document.addEventListener('touchstart', (e) => {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
    });

    document.addEventListener('touchend', (e) => {
        if (!document.querySelector('#about').classList.contains('active')) return;

        const touchEndX = e.changedTouches[0].clientX;
        const touchEndY = e.changedTouches[0].clientY;
        const deltaX = touchEndX - touchStartX;
        const deltaY = touchEndY - touchStartY;

        if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
            const items = Array.from(document.querySelectorAll('.aboutItem'));
            const currentIndex = items.findIndex(item => item.classList.contains('active'));

            if (deltaX > 0 && currentIndex > 0) {
                // Swipe right - previous item
                const eventName = items[currentIndex - 1].getAttribute('onclick').match(/'([^']+)'/)[1];
                showEvent(eventName);
            } else if (deltaX < 0 && currentIndex < items.length - 1) {
                // Swipe left - next item
                const eventName = items[currentIndex + 1].getAttribute('onclick').match(/'([^']+)'/)[1];
                showEvent(eventName);
            }
        }
    });
}
